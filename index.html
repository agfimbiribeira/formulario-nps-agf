<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesquisa de Neg√≥cios - AGF BAIRRO IMBIRIBEIRA</title>
    <style>
        :root {
            --cor-azul-correios: #00416B;
            --cor-amarelo-correios: #FFDA00;
            --cor-azul-claro-correios: #0083CA;
            --cor-amarelo-hover: #e6c200;
            --cor-fundo: #f0f2f5;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--cor-fundo); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 1em; box-sizing: border-box; }
        .container { background: white; padding: 2.5em; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); width: 100%; max-width: 600px; text-align: center; }
        h1 { color: var(--cor-azul-correios); font-size: 1.8em; margin-top: 0; margin-bottom: 0.5em; }
        .description { color: #555; margin-bottom: 2em; font-size: 1.1em; line-height: 1.6; }
        .form-group { margin-bottom: 1.5em; text-align: left; }
        .checkbox-item, .radio-group div { display: flex; align-items: center; margin-bottom: 0.8em; }
        .checkbox-item label, .radio-group label { font-weight: normal; margin-left: 0.7em; }
        /* Estilo para os campos de texto "Outro" */
        .outro-input { display: none; margin-left: 1em; padding: 0.5em; border: 1px solid #ccc; border-radius: 4px; font-size: 0.9em; flex-grow: 1; }
        #businessQuestions { display: none; border-top: 1px solid #eee; margin-top: 2em; padding-top: 2em; }
        label { display: block; margin-bottom: 0.7em; font-weight: 600; color: #333; }
        input[type="text"], input[type="number"], select, textarea { width: 100%; padding: 0.9em; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1em; }
        button { width: 100%; padding: 1em; margin-top: 1.5em; background-color: var(--cor-amarelo-correios); color: var(--cor-azul-correios); border: none; border-radius: 6px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        button:hover { background-color: var(--cor-amarelo-hover); transform: translateY(-2px); }
        #message { text-align: center; margin-top: 1.5em; font-weight: bold; min-height: 1.2em; font-size: 1.1em; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Vamos conhecer melhor o seu neg√≥cio?</h1>
        <p class="description">Ol√°! üòä Para oferecermos um servi√ßo ainda melhor, queremos entender suas necessidades. Leva s√≥ 2 minutinhos!</p>
        
        <form id="businessForm">
            <div class="form-group">
                <label for="nomeCliente">Seu nome ou nome da empresa:</label>
                <input type="text" id="nomeCliente" name="Nome do Cliente" required>
            </div>
            <div class="form-group radio-group">
                <label>Voc√™ vende produtos online?</label>
                <div class="radio-item"><input type="radio" id="vendeSim" name="Vende Online" value="Sim" required><label for="vendeSim">Sim</label></div>
                <div class="radio-item"><input type="radio" id="vendeNao" name="Vende Online" value="N√£o"><label for="vendeNao">N√£o</label></div>
            </div>

            <div id="businessQuestions">
                <div class="form-group checkbox-group">
                    <label>Quais plataformas de e-commerce voc√™ utiliza?</label>
                    <div class="checkbox-item"><input type="checkbox" id="p_shopify" value="Shopify"><label for="p_shopify">Shopify</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="p_nuvemshop" value="Nuvemshop"><label for="p_nuvemshop">Nuvemshop</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="p_loja" value="Loja Integrada"><label for="p_loja">Loja Integrada</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="p_woo" value="WooCommerce"><label for="p_woo">WooCommerce</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="p_tiktok" value="TikTok Shop"><label for="p_tiktok">TikTok Shop</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="p_outro"><label for="p_outro">Outra:</label><input type="text" id="p_outro_text" class="outro-input" placeholder="Qual?"></div>
                </div>
                <div class="form-group checkbox-group">
                    <label>E marketplaces, voc√™ vende em algum destes?</label>
                    <div class="checkbox-item"><input type="checkbox" id="m_meli" value="Mercado Livre"><label for="m_meli">Mercado Livre</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="m_amazon" value="Amazon"><label for="m_amazon">Amazon</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="m_magalu" value="Magalu"><label for="m_magalu">Magalu</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="m_shopee" value="Shopee"><label for="m_shopee">Shopee</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="m_outro"><label for="m_outro">Outro:</label><input type="text" id="m_outro_text" class="outro-input" placeholder="Qual?"></div>
                </div>
                <div class="form-group checkbox-group">
                    <label>Voc√™ utiliza algum sistema de gest√£o (ERP)?</label>
                    <div class="checkbox-item"><input type="checkbox" id="e_bling" value="Bling"><label for="e_bling">Bling</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="e_tiny" value="TinyERP"><label for="e_tiny">TinyERP</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="e_outro"><label for="e_outro">Outro:</label><input type="text" id="e_outro_text" class="outro-input" placeholder="Qual?"></div>
                    <div class="checkbox-item"><input type="checkbox" id="e_nao" value="N√£o utilizo"><label for="e_nao">N√£o utilizo</label></div>
                </div>
                <!-- ... Outras perguntas ... -->
                <div class="form-group radio-group">
                    <label>Voc√™ utiliza os servi√ßos dos Correios em todas as plataformas que vende?</label>
                    <div class="radio-item"><input type="radio" id="usaSim" name="Usa Correios em Todas" value="Sim"><label for="usaSim">Sim</label></div>
                    <div class="radio-item"><input type="radio" id="usaNao" name="Usa Correios em Todas" value="N√£o, uso outras transportadoras tamb√©m"><label for="usaNao">N√£o, uso outras transportadoras tamb√©m</label></div>
                </div>
                <div class="form-group">
                    <label for="enviosMes">Qual sua m√©dia de envios mensais pelos Correios?</label>
                    <select id="enviosMes" name="Envios por M√™s"><option value="" disabled selected>Selecione uma faixa</option><option value="1-10">1 a 10</option><option value="11-50">11 a 50</option><option value="51-100">51 a 100</option><option value="101-500">101 a 500</option><option value="Mais de 500">Mais de 500</option></select>
                </div>
                <div class="form-group">
                    <label for="importancia">De 0 a 10, qual a import√¢ncia dos Correios para o seu neg√≥cio?</label>
                    <input type="number" id="importancia" name="Import√¢ncia dos Correios" min="0" max="10">
                </div>
                <div class="form-group">
                    <label for="sugestoes">Tem alguma sugest√£o ou servi√ßo que gostaria que oferec√™ssemos?</label>
                    <textarea id="sugestoes" name="Sugest√µes"></textarea>
                </div>
            </div>

            <button type="submit" id="submitButton">Enviar Resposta</button>
            <p id="message"></p>
        </form>
    </div>
    <script>
        const form = document.getElementById('businessForm');
        const scriptURL = 'https://script.google.com/macros/s/AKfycbw0pWdiR7XwPD_a_chM8AcCbxGaIxWOY_Nowc2PnC2xBD3ha2te2LNdPY4TSlowcLr5ug/exec';

        // L√≥gica para mostrar/esconder o bloco de perguntas de neg√≥cio
        document.querySelectorAll('input[name="Vende Online"]').forEach(radio => {
            radio.addEventListener('change', event => {
                document.getElementById('businessQuestions').style.display = event.target.value === 'Sim' ? 'block' : 'none';
            });
        });

        // L√≥gica para mostrar/esconder os campos de texto "Outro"
        function setupOutroField(checkboxId, textFieldId) {
            const checkbox = document.getElementById(checkboxId);
            const textField = document.getElementById(textFieldId);
            checkbox.addEventListener('change', () => {
                textField.style.display = checkbox.checked ? 'block' : 'none';
                if (!checkbox.checked) textField.value = ''; // Limpa o campo se desmarcado
            });
        }
        setupOutroField('p_outro', 'p_outro_text');
        setupOutroField('m_outro', 'm_outro_text');
        setupOutroField('e_outro', 'e_outro_text');
        
        form.addEventListener('submit', e => {
            e.preventDefault();
            document.getElementById('submitButton').disabled = true;
            document.getElementById('submitButton').textContent = 'Enviando...';
            
            const formData = new FormData(form);

            // Fun√ß√£o para coletar dados dos checkboxes de forma inteligente
            function getCheckboxData(checkboxIds, outroCheckboxId, outroTextId) {
                const values = [];
                checkboxIds.forEach(id => {
                    const cb = document.getElementById(id);
                    if (cb.checked) values.push(cb.value);
                });
                const outroCb = document.getElementById(outroCheckboxId);
                const outroText = document.getElementById(outroTextId);
                if (outroCb.checked && outroText.value) {
                    values.push(`Outra: ${outroText.value}`);
                }
                return values.join(', ');
            }

            const plataformas = getCheckboxData(['p_shopify', 'p_nuvemshop', 'p_loja', 'p_woo', 'p_tiktok'], 'p_outro', 'p_outro_text');
            const marketplaces = getCheckboxData(['m_meli', 'm_amazon', 'm_magalu', 'm_shopee'], 'm_outro', 'm_outro_text');
            const erps = getCheckboxData(['e_bling', 'e_tiny', 'e_nao'], 'e_outro', 'e_outro_text');
            
            formData.set('Plataformas', plataformas);
            formData.set('Marketplaces', marketplaces);
            formData.set('ERPs', erps);
            formData.append('Data/Hora', new Date().toLocaleString('pt-BR', { timeZone: 'America/Sao_Paulo' }));

            fetch(scriptURL, { method: 'POST', body: formData })
                .then(response => response.json())
                .then(data => {
                    if(data.result === 'success'){
                        document.getElementById('message').textContent = 'Obrigado por suas respostas!';
                        document.getElementById('message').className = 'success';
                        form.reset();
                        document.getElementById('businessQuestions').style.display = 'none';
                        // Garante que os campos de texto "Outro" fiquem escondidos ap√≥s o reset
                        document.getElementById('p_outro_text').style.display = 'none';
                        document.getElementById('m_outro_text').style.display = 'none';
                        document.getElementById('e_outro_text').style.display = 'none';
                    } else { throw new Error(data.message || 'Erro desconhecido'); }
                })
                .catch(error => {
                    document.getElementById('message').textContent = 'Erro ao enviar. Tente novamente.';
                    document.getElementById('message').className = 'error';
                })
                .finally(() => {
                    document.getElementById('submitButton').disabled = false;
                    document.getElementById('submitButton').textContent = 'Enviar Resposta';
                });
        });
    </script>
</body>
</html>
