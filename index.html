<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesquisa de Neg√≥cios - AGF BAIRRO IMBIRIBEIRA</title>
    <style>
        :root {
            --cor-azul-correios: #00416B;
            --cor-amarelo-correios: #FFDA00;
            --cor-azul-claro-correios: #0083CA;
            --cor-amarelo-hover: #e6c200;
            --cor-fundo: #f0f2f5;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--cor-fundo); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 1em; box-sizing: border-box; }
        .container { background: white; padding: 2.5em; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); width: 100%; max-width: 600px; text-align: center; }
        h1 { color: var(--cor-azul-correios); font-size: 1.8em; margin-top: 0; margin-bottom: 0.5em; }
        .description { color: #555; margin-bottom: 2em; font-size: 1.1em; line-height: 1.6; }
        .form-group { margin-bottom: 1.5em; text-align: left; }
        .checkbox-item, .radio-group .radio-item { display: flex; align-items: center; margin-bottom: 0.8em; }
        .checkbox-item label, .radio-group label { font-weight: normal; margin-left: 0.7em; cursor: pointer; }
        .outro-input { display: none; margin-left: 1em; padding: 0.5em; border: 1px solid #ccc; border-radius: 4px; font-size: 0.9em; flex-grow: 1; }
        #businessQuestions { display: none; border-top: 1px solid #eee; margin-top: 2em; padding-top: 2em; }
        label { display: block; margin-bottom: 0.7em; font-weight: 600; color: #333; }
        input[type="text"], input[type="number"], select, textarea { width: 100%; padding: 0.9em; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1em; }
        button { width: 100%; padding: 1em; margin-top: 1.5em; background-color: var(--cor-amarelo-correios); color: var(--cor-azul-correios); border: none; border-radius: 6px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        button:hover { background-color: var(--cor-amarelo-hover); transform: translateY(-2px); }
        #message { text-align: center; margin-top: 1.5em; font-weight: bold; min-height: 1.2em; font-size: 1.1em; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Vamos conhecer melhor o seu neg√≥cio?</h1>
        <p class="description">Ol√°! üòä Para oferecermos um servi√ßo ainda melhor, queremos entender suas necessidades. Leva s√≥ 2 minutinhos!</p>
        
        <form id="businessForm" novalidate>
            <div class="form-group">
                <label for="nomeCliente">Seu nome ou nome da empresa:</label>
                <input type="text" id="nomeCliente" name="Nome do Cliente" required>
            </div>
            <div class="form-group radio-group">
                <label>Voc√™ vende produtos online?</label>
                <div class="radio-item"><input type="radio" id="vendeSim" name="Vende Online" value="Sim" required><label for="vendeSim">Sim</label></div>
                <div class="radio-item"><input type="radio" id="vendeNao" name="Vende Online" value="N√£o"><label for="vendeNao">N√£o</label></div>
            </div>

            <div id="businessQuestions">
                <div class="form-group checkbox-group">
                    <label>Quais plataformas de e-commerce voc√™ utiliza? (obrigat√≥rio)</label>
                    <div class="checkbox-item"><input type="checkbox" data-group="plataformas" value="Shopify"><label for="p_shopify">Shopify</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="plataformas" value="Nuvemshop"><label for="p_nuvemshop">Nuvemshop</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="plataformas" value="Loja Integrada"><label for="p_loja">Loja Integrada</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="plataformas" value="WooCommerce"><label for="p_woo">WooCommerce</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="p_outro"><label for="p_outro">Outra:</label><input type="text" id="p_outro_text" class="outro-input" placeholder="Qual?"></div>
                </div>
                <div class="form-group checkbox-group">
                    <label>E marketplaces, voc√™ vende em algum destes? (obrigat√≥rio)</label>
                    <div class="checkbox-item"><input type="checkbox" data-group="marketplaces" value="Mercado Livre"><label for="m_meli">Mercado Livre</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="marketplaces" value="Amazon"><label for="m_amazon">Amazon</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="marketplaces" value="Magalu"><label for="m_magalu">Magalu</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="marketplaces" value="Shopee"><label for="m_shopee">Shopee</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="marketplaces" value="TikTok Shop"><label for="m_tiktok">TikTok Shop</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="m_outro"><label for="m_outro">Outro:</label><input type="text" id="m_outro_text" class="outro-input" placeholder="Qual?"></div>
                </div>
                <div class="form-group checkbox-group">
                    <label>Voc√™ utiliza algum sistema de gest√£o (ERP)? (obrigat√≥rio)</label>
                    <div class="checkbox-item"><input type="checkbox" data-group="erps" value="Bling"><label for="e_bling">Bling</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="erps" value="TinyERP"><label for="e_tiny">TinyERP</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="erps" value="N√£o utilizo"><label for="e_nao">N√£o utilizo</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="e_outro"><label for="e_outro">Outro:</label><input type="text" id="e_outro_text" class="outro-input" placeholder="Qual?"></div>
                </div>
                <div class="form-group checkbox-group">
                    <label>Para seus envios, al√©m dos Correios, voc√™ utiliza outras transportadoras? (obrigat√≥rio)</label>
                    <div class="checkbox-item"><input type="checkbox" data-group="transportadoras" value="Jadlog"><label for="t_jadlog">Jadlog</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="transportadoras" value="Loggi"><label for="t_loggi">Loggi</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="transportadoras" value="Azul Cargo Express"><label for="t_azul">Azul Cargo Express</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="transportadoras" value="Transportadora Local / Motoboy"><label for="t_local">Transportadora Local / Motoboy</label></div>
                    <div class="checkbox-item"><input type="checkbox" data-group="transportadoras" value="Utilizo somente os Correios"><label for="t_somente">Utilizo somente os Correios</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="t_outro"><label for="t_outro">Outra:</label><input type="text" id="t_outro_text" class="outro-input" placeholder="Qual?"></div>
                </div>
                <div class="form-group">
                    <label for="enviosMes">Qual sua m√©dia de envios mensais pelos Correios?</label>
                    <select id="enviosMes" name="Envios por M√™s" required><option value="" disabled selected>Selecione uma faixa</option><option value="1-10">1 a 10</option><option value="11-50">11 a 50</option><option value="51-100">51 a 100</option><option value="101-500">101 a 500</option><option value="Mais de 500">Mais de 500</option></select>
                </div>
                <!-- PERGUNTA REFORMULADA AQUI -->
                <div class="form-group">
                    <label for="shareCorreios">Do total de seus envios, qual parte √© feita pelos Correios?</label>
                    <select id="shareCorreios" name="Share dos Correios" required>
                        <option value="" disabled selected>Selecione uma op√ß√£o</option>
                        <option value="Todos os meus envios (100%)">Todos os meus envios (100%)</option>
                        <option value="A grande maioria (mais de 75%)">A grande maioria (mais de 75%)</option>
                        <option value="Cerca da metade (entre 25% e 75%)">Cerca da metade (entre 25% e 75%)</option>
                        <option value="Uma pequena parte (menos de 25%)">Uma pequena parte (menos de 25%)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="sugestoes">Tem alguma sugest√£o ou servi√ßo que gostaria que oferec√™ssemos? (opcional)</label>
                    <textarea id="sugestoes" name="Sugest√µes"></textarea>
                </div>
            </div>

            <button type="submit" id="submitButton">Enviar Resposta</button>
            <p id="message"></p>
        </form>
    </div>
    <script>
        const form = document.getElementById('businessForm');
        // A sua URL mais recente est√° aqui. N√£o √© preciso alter√°-la.
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwPoGmreKPabOftxAgt2Jx1xJmCdGs45N_2Sn7V3G2xc49KuAlaJvQ395EagqFF_k9NbQ/exec';

        document.querySelectorAll('input[name="Vende Online"]').forEach(radio => {
            radio.addEventListener('change', event => {
                document.getElementById('businessQuestions').style.display = event.target.value === 'Sim' ? 'block' : 'none';
            });
        });

        function setupOutroField(checkboxId, textFieldId) {
            const checkbox = document.getElementById(checkboxId);
            const textField = document.getElementById(textFieldId);
            checkbox.addEventListener('change', (e) => {
                textField.style.display = e.target.checked ? 'block' : 'none';
                if (!e.target.checked) textField.value = '';
            });
        }
        setupOutroField('p_outro', 'p_outro_text');
        setupOutroField('m_outro', 'm_outro_text');
        setupOutroField('e_outro', 'e_outro_text');
        setupOutroField('t_outro', 't_outro_text');
        
        form.addEventListener('submit', e => {
            e.preventDefault();
            const submitButton = document.getElementById('submitButton');
            const messageDiv = document.getElementById('message');
            
            // L√≥gica de valida√ß√£o
            if (document.querySelector('input[name="Vende Online"]:checked')?.value === 'Sim') {
                const checkGroup = (groupName) => document.querySelectorAll(`input[data-group="${groupName}"]:checked, input#${groupName.slice(0,1)}_outro:checked`).length > 0;
                
                if (!checkGroup('plataformas')) { alert('Por favor, selecione ao menos uma op√ß√£o em "Plataformas de e-commerce".'); return; }
                if (!checkGroup('marketplaces')) { alert('Por favor, selecione ao menos uma op√ß√£o em "Marketplaces".'); return; }
                if (!checkGroup('erps')) { alert('Por favor, selecione ao menos uma op√ß√£o em "Sistema de gest√£o (ERP)".'); return; }
                if (!checkGroup('transportadoras')) { alert('Por favor, selecione ao menos uma op√ß√£o em "Outras Transportadoras".'); return; }
                if (document.getElementById('enviosMes').value === '') { alert('Por favor, selecione a faixa de envios mensais.'); return; }
                if (document.getElementById('shareCorreios').value === '') { alert('Por favor, selecione qual parte dos seus envios √© feita pelos Correios.'); return; }
            }

            submitButton.disabled = true;
            submitButton.textContent = 'Enviando...';
            messageDiv.textContent = '';
            
            const formData = new FormData();
            formData.append('Data/Hora', new Date().toLocaleString('pt-BR', { timeZone: 'America/Sao_Paulo' }));
            formData.append('Nome do Cliente', document.getElementById('nomeCliente').value);
            const vendeOnlineValue = document.querySelector('input[name="Vende Online"]:checked')?.value || '';
            formData.append('Vende Online', vendeOnlineValue);

            if (vendeOnlineValue === 'Sim') {
                const getCheckboxData = (groupName, outroCbId, outroTxtId) => {
                    const values = Array.from(document.querySelectorAll(`input[data-group="${groupName}"]:checked`)).map(cb => cb.value);
                    const outroCb = document.getElementById(outroCbId);
                    const outroTxt = document.getElementById(outroTxtId).value.trim();
                    if (outroCb && outroCb.checked && outroTxt) { values.push(`Outra: ${outroTxt}`); }
                    return values.join(', ');
                };
                
                formData.append('Plataformas', getCheckboxData('plataformas', 'p_outro', 'p_outro_text'));
                formData.append('Marketplaces', getCheckboxData('marketplaces', 'm_outro', 'm_outro_text'));
                formData.append('ERPs', getCheckboxData('erps', 'e_outro', 'e_outro_text'));
                formData.append('Outras Transportadoras', getCheckboxData('transportadoras', 't_outro', 't_outro_text'));

                formData.append('Envios por M√™s', document.getElementById('enviosMes').value);
                formData.append('Share dos Correios', document.getElementById('shareCorreios').value);
                formData.append('Sugest√µes', document.getElementById('sugestoes').value);
            }

            fetch(scriptURL, { method: 'POST', body: formData })
                .then(response => {
                    if (!response.ok) return response.text().then(text => { throw new Error(`Erro do servidor: ${text}`) });
                    return response.json();
                })
                .then(data => {
                    if (data.result === 'success') {
                        messageDiv.textContent = 'Obrigado por suas respostas!';
                        messageDiv.className = 'success';
                        form.reset();
                        document.getElementById('businessQuestions').style.display = 'none';
                        ['p_outro_text', 'm_outro_text', 'e_outro_text', 't_outro_text'].forEach(id => { const el = document.getElementById(id); if (el) el.style.display = 'none'; });
                    } else { throw new Error(data.message || 'Erro desconhecido retornado pelo script'); }
                })
                .catch(error => {
                    console.error('Erro detalhado:', error);
                    messageDiv.textContent = 'Erro ao enviar. Por favor, tente novamente.';
                    messageDiv.className = 'error';
                })
                .finally(() => {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Enviar Resposta';
                });
        });
    </script>
</body>
</html>
